"use strict";(self["webpackChunkhmtt"]=self["webpackChunkhmtt"]||[]).push([[268],{5686:function(t,e,n){n.r(e),n.d(e,{default:function(){return w}});var i=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("van-nav-bar",{attrs:{fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[e("img",{staticClass:"logo",attrs:{src:n(6148),alt:""}})]},proxy:!0},{key:"right",fn:function(){return[e("van-icon",{attrs:{name:"search",size:"0.48rem",color:"#fff"},on:{click:t.moveSearchPageFn}})]},proxy:!0}])})],1),e("div",{staticClass:"main"},[e("van-tabs",{attrs:{sticky:"","offset-top":"1.226667rem",animated:""},on:{change:t.channelChangeFn},model:{value:t.channelId,callback:function(e){t.channelId=e},expression:"channelId"}},t._l(t.userChannelList,(function(n){return e("van-tab",{key:n.id,attrs:{title:n.name,name:n.id}},[e("ArticleList",{attrs:{cid:t.channelId}})],1)})),1)],1),e("van-icon",{staticClass:"moreChannels",attrs:{name:"plus",size:"0.37333334rem"},on:{click:t.showPopup}}),e("van-popup",{staticClass:"channel-popup",attrs:{"get-container":"body"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("ChannelEdit",{ref:"editRef",attrs:{userChannelList:t.userChannelList,unCheckChannelList:t.unCheckChannelList},on:{addChannelEV:t.addChannelFn,removeChannelEV:t.removeChannelEV,closeEV:t.closeFn},model:{value:t.channelId,callback:function(e){t.channelId=e},expression:"channelId"}})],1)],1)},s=[],a=(n(7658),n(8542)),l=function(){var t=this,e=t._self._c;return e("div",[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",offset:"50","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(n){return e("ArticleItem",{key:n.art_id,attrs:{artObj:n},on:{disLikeEV:t.disLikeFn,reportEV:t.reportFn},nativeOn:{click:function(e){return t.itemClickFn(n.art_id)}}})})),1)],1)],1)},o=[],c=n(6834),r=n(9262),d={data(){return{list:[],loading:!1,finished:!1,theTime:(new Date).getTime(),isLoading:!1}},props:{cid:Number},components:{ArticleItem:c.Z},async created(){const t=await(0,a.ii)({channelid:this.cid,timestamp:this.theTime});this.list=t.data.data.results,this.theTime=t.data.data.pre_timestamp},methods:{async getArticleListFn(){const t=await(0,a.ii)({channelid:this.cid,timestamp:this.theTime});console.log(t),this.list=[...this.list,...t.data.data.results],this.theTime=t.data.data.pre_timestamp,this.loading=!1,null===this.list.pre_timestamp&&(this.finished=!0),this.isLoading=!1},onLoad(){0!==this.list.length?this.getArticleListFn():this.loading=!1},async onRefresh(){this.list=[],this.theTime=(new Date).getTime(),this.getArticleListFn()},async disLikeFn(t){await(0,a.AJ)({artId:t}),(0,r.Z)({type:"success",message:"反馈成功"})},async reportFn(t,e){await(0,a.sk)({target:t,type:e}),(0,r.Z)({type:"success",message:"反馈成功"})},itemClickFn(t){this.$router.push(`/detail?art_id=${t}`)}}},h=d,u=n(1001),f=(0,u.Z)(h,l,o,!1,null,null,null),m=f.exports,p=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{title:"频道管理"},scopedSlots:t._u([{key:"right",fn:function(){return[e("van-icon",{attrs:{name:"cross",size:"0.37333334rem",color:"white"},on:{click:t.closeFn}})]},proxy:!0}])}),e("div",{staticClass:"my-channel-box"},[e("div",{staticClass:"channel-title"},[e("span",[t._v("我的频道 "),e("span",{staticClass:"small-title"},[t._v(" 点击"+t._s(t.isEdit?"删除":"进入")+"频道 ")])]),e("span",{on:{click:t.editFn}},[t._v(t._s(t.isEdit?"完成":"编辑"))])]),e("van-row",{attrs:{type:"flex"}},t._l(t.userChannelList,(function(n){return e("van-col",{key:n.id,attrs:{span:"6"},on:{click:function(e){return t.userChannelClickFn(n)}}},[e("div",{staticClass:"channel-item van-hairline--surround"},[t._v(" "+t._s(n.name)+" "),e("van-badge",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&0!==n.id,expression:"isEdit && obj.id !== 0"}],staticClass:"cross-badge",attrs:{color:"transparent"},scopedSlots:t._u([{key:"content",fn:function(){return[e("van-icon",{staticClass:"badge-icon",attrs:{name:"cross",color:"#cfcfcf",size:"0.32rem"}})]},proxy:!0}],null,!0)})],1)])})),1)],1),e("div",{staticClass:"more-channel-box"},[t._m(0),e("van-row",{attrs:{type:"flex"}},t._l(t.unCheckChannelList,(function(n){return e("van-col",{key:n.id,attrs:{span:"6"},on:{click:function(e){return t.moreFn(n)}}},[e("div",{staticClass:"channel-item van-hairline--surround"},[t._v(t._s(n.name))])])})),1)],1)],1)},v=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"channel-title"},[e("span",[t._v("点击添加更多频道：")])])}],g={props:{userChannelList:Array,unCheckChannelList:Array},data(){return{isEdit:!1}},methods:{editFn(){this.isEdit=!this.isEdit},moreFn(t){!0===this.isEdit&&this.$emit("addChannelEV",t)},userChannelClickFn(t){!0===this.isEdit?0!==t.id&&this.$emit("removeChannelEV",t):(this.$emit("closeEV"),this.$emit("input",t.id))},closeFn(){this.$emit("closeEV")}}},C=g,k=(0,u.Z)(C,p,v,!1,null,"29632cc4",null),y=k.exports,L={data(){return{channelId:0,userChannelList:[],allChannelList:[],show:!1,channelScrollTObj:{}}},async created(){const t=await(0,a.lS)();console.log(t),this.userChannelList=t.data.data.channels;const e=await(0,a.Of)();this.allChannelList=e.data.data.channels,console.log(e)},components:{ArticleList:m,ChannelEdit:y},methods:{showPopup(){this.show=!0},async addChannelFn(t){this.userChannelList.push(t);const e=this.userChannelList.filter((t=>0!==t.od)),n=e.map(((t,e)=>{const n={...t};return delete n.name,n.seq=e,n})),i=await(0,a.w0)({channels:n});console.log(i)},async removeChannelEV(t){const e=this.userChannelList.findIndex((e=>e.id===t.id));this.userChannelList.splice(e,1),await(0,a.Mz)({target:t.id})},closeFn(){this.show=!1,this.$refs.editRef.isEdit=!1},moveSearchPageFn(){this.$router.push("/search")},scrollFn(){this.$route.meta.scrollT=document.documentElement.scrollTop,this.channelScrollTObj[this.channelId]=document.documentElement.scrollTop},channelChangeFn(){console.log(111),this.$nextTick((()=>{document.documentElement.scrollTop=this.channelScrollTObj[this.channelId]}))}},computed:{unCheckChannelList(){return this.allChannelList.filter((t=>-1===this.userChannelList.findIndex((e=>e.id===t.id))))}},activated(){window.addEventListener("scroll",this.scrollFn),document.documentElement.scrollTop=this.$route.meta.scrollT},deactivated(){window.removeEventListener("scroll",this.scrollFn)}},b=L,E=(0,u.Z)(b,i,s,!1,null,"356faf6c",null),w=E.exports},9262:function(t,e,n){n.d(e,{Z:function(){return $}});n(5623),n(4966),n(4933),n(3671),n(3979),n(6121),n(7658);var i=n(9037),s=n(8099),a=n(5127),l=n(44),o=0;function c(t){t?(o||document.body.classList.add("van-toast--unclickable"),o++):(o--,o||document.body.classList.remove("van-toast--unclickable"))}var r=n(9607),d=n(9757),h=n(5393),u=(0,a.d)("toast"),f=u[0],m=u[1],p=f({mixins:[(0,r.e)()],props:{icon:String,className:null,iconPrefix:String,loadingType:String,forbidClick:Boolean,closeOnClick:Boolean,message:[Number,String],type:{type:String,default:"text"},position:{type:String,default:"middle"},transition:{type:String,default:"van-fade"},lockScroll:{type:Boolean,default:!1}},data:function(){return{clickable:!1}},mounted:function(){this.toggleClickable()},destroyed:function(){this.toggleClickable()},watch:{value:"toggleClickable",forbidClick:"toggleClickable"},methods:{onClick:function(){this.closeOnClick&&this.close()},toggleClickable:function(){var t=this.value&&this.forbidClick;this.clickable!==t&&(this.clickable=t,c(t))},onAfterEnter:function(){this.$emit("opened"),this.onOpened&&this.onOpened()},onAfterLeave:function(){this.$emit("closed")},genIcon:function(){var t=this.$createElement,e=this.icon,n=this.type,i=this.iconPrefix,s=this.loadingType,a=e||"success"===n||"fail"===n;return a?t(d.Z,{class:m("icon"),attrs:{classPrefix:i,name:e||n}}):"loading"===n?t(h.Z,{class:m("loading"),attrs:{type:s}}):void 0},genMessage:function(){var t=this.$createElement,e=this.type,n=this.message;if((0,l.Xq)(n)&&""!==n)return"html"===e?t("div",{class:m("text"),domProps:{innerHTML:n}}):t("div",{class:m("text")},[n])}},render:function(){var t,e=arguments[0];return e("transition",{attrs:{name:this.transition},on:{afterEnter:this.onAfterEnter,afterLeave:this.onAfterLeave}},[e("div",{directives:[{name:"show",value:this.value}],class:[m([this.position,(t={},t[this.type]=!this.icon,t)]),this.className],on:{click:this.onClick}},[this.genIcon(),this.genMessage()])])}}),v=n(5719),g={icon:"",type:"text",mask:!1,value:!0,message:"",className:"",overlay:!1,onClose:null,onOpened:null,duration:2e3,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,getContainer:"body",overlayStyle:null,closeOnClick:!1,closeOnClickOverlay:!1},C={},k=[],y=!1,L=(0,i.Z)({},g);function b(t){return(0,l.Kn)(t)?t:{message:t}}function E(t){return document.body.contains(t)}function w(){if(l.sk)return{};if(k=k.filter((function(t){return!t.$el.parentNode||E(t.$el)})),!k.length||y){var t=new(s.ZP.extend(p))({el:document.createElement("div")});t.$on("input",(function(e){t.value=e})),k.push(t)}return k[k.length-1]}function x(t){return(0,i.Z)({},t,{overlay:t.mask||t.overlay,mask:void 0,duration:void 0})}function _(t){void 0===t&&(t={});var e=w();return e.value&&e.updateZIndex(),t=b(t),t=(0,i.Z)({},L,C[t.type||L.type],t),t.clear=function(){e.value=!1,t.onClose&&(t.onClose(),t.onClose=null),y&&!l.sk&&e.$on("closed",(function(){clearTimeout(e.timer),k=k.filter((function(t){return t!==e})),(0,v.Z)(e.$el),e.$destroy()}))},(0,i.Z)(e,x(t)),clearTimeout(e.timer),t.duration>0&&(e.timer=setTimeout((function(){e.clear()}),t.duration)),e}var F=function(t){return function(e){return _((0,i.Z)({type:t},b(e)))}};["loading","success","fail"].forEach((function(t){_[t]=F(t)})),_.clear=function(t){k.length&&(t?(k.forEach((function(t){t.clear()})),k=[]):y?k.shift().clear():k[0].clear())},_.setDefaultOptions=function(t,e){"string"===typeof t?C[t]=e:(0,i.Z)(L,t)},_.resetDefaultOptions=function(t){"string"===typeof t?C[t]=null:(L=(0,i.Z)({},g),C={})},_.allowMultiple=function(t){void 0===t&&(t=!0),y=t},_.install=function(){s.ZP.use(p)},s.ZP.prototype.$toast=_;var T=_,$=({type:t,message:e})=>{"danger"===t&&(t="fail"),T({type:t,message:e})}},6148:function(t,e,n){t.exports=n.p+"img/Logo.d0d391a4.png"}}]);
//# sourceMappingURL=Home.bf9c8152.js.map